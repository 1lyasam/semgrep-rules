rules:
- fix-regex:
    regex: MONGODB-CR
    replacement: SCRAM-SHA-256
  id: mongo-client-bad-auth
  languages:
  - python
  message: Warning MONGODB-CR was deprecated with the release of MongoDB 3.6 and is
    no longer supported by MongoDB 4.0 (see https://api.mongodb.com/python/current/examples/authentication.html
    for details).
  metadata:
    category: security
    cwe: "CWE-16: Configuration"
    technology:
    - pymongo
  pattern: |
    pymongo.MongoClient(..., authMechanism='MONGODB-CR')
  severity: WARNING
