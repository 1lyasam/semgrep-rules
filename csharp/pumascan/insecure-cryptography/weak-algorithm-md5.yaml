rules:
- id: weak-algorithm-md5
  languages:
  - csharp
  message: The MD5CryptoServiceProvider class uses the weak MD5 algorithm and is not
    an approved hashing algorithm.
  metadata:
    category: security
    cwe: 'CWE-327: Use of a Broken or Risky Cryptographic Algorithm'
    owasp:
    - A03:2017 - Sensitive Data Exposure
    - A02:2021 - Cryptographic Failures
    references:
    - https://msdn.microsoft.com/en-us/library/system.security.cryptography.md5cryptoserviceprovider(v=vs.110).aspx
    - https://msdn.microsoft.com/en-us/library/system.security.cryptography.sha256(v=vs.110).aspx
    - https://msdn.microsoft.com/en-us/library/system.security.cryptography.sha512(v=vs.110).aspx
    - https://blogs.dropbox.com/tech/2016/09/how-dropbox-securely-stores-your-passwords/
    source-rule-url: https://pumascan.com/rules/#sec0027-weak-algorithm-md5
    technology:
    - .net
  mode: search
  patterns:
  - pattern: new MD5CryptoServiceProvider()
  severity: WARNING
