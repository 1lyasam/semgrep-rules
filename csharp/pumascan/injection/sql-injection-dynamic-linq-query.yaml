rules:
- id: sql-injection-dynamic-linq-query
  languages:
  - csharp
  message: 'Concatenating untrusted data into a dynamic SQL string and calling vulnerable
    LINQ methods can allow SQL Injection:'
  metadata:
    category: security
    cwe: 'CWE-89: Improper Neutralization of Special Elements used in an SQL Command
      (''SQL Injection'')'
    owasp:
    - A01:2017 - Injection
    - A03:2021 - Injection
    references:
    - https://www.owasp.org/index.php/Top_10-2017_A1-Injection
    - https://msdn.microsoft.com/en-us/library/bb361109(v=vs.110).aspx
    source-rule-url: https://pumascan.com/rules/#sec0106-sql-injection-dynamic-linq-query
    technology:
    - .net
  mode: taint
  pattern-sources:
    - patterns:
      - pattern: $ARG
      - pattern-inside: |
          public $TYPE $M(...,$ARG,...){...}
      - pattern-either: 
        - pattern: |
            "..." + $ARG
        - pattern: |
            "..." + $ARG.$P
  pattern-sinks:
    - patterns:
      - pattern: |
          (DbDataContext $CONTEXT).ExecuteQuery<$T>(...)
  severity: WARNING
