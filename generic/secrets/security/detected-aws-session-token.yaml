rules:
- id: detected-aws-session-token
  languages:
  - regex
  message: AWS Session Token detected
  metadata:
    category: security
    confidence: MEDIUM
    cwe: "CWE-798: Use of Hard-coded Credentials"
    source-rule-url: https://github.com/grab/secret-scanner/blob/master/scanner/signatures/pattern.go
    technology:
    - secrets
    - aws
  patterns:
  - pattern-regex: (("|'|`)?((?i)aws)?_?((?i)session)_?((?i)token)("|'|`)?\s{0,50}(:|=>|=)\s{0,50}("|'|`)?[A-Za-z0-9/+=]{16,}("|'|`)?)
  - pattern-not-regex: (?i)example|sample|test|fake
  severity: ERROR
