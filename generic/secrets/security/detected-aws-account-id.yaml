rules:
- id: detected-aws-account-id
  languages:
  - generic
  message: AWS Account ID detected. This is a sensitive credential and should not
    be hardcoded here. Instead, read the value from an environment variable or keep
    the value in a separate, private file.
  metadata:
    category: security
    confidence: MEDIUM
    cwe: "CWE-798: Use of Hard-coded Credentials"
    source-rule-url: https://github.com/grab/secret-scanner/blob/master/scanner/signatures/pattern.go
    technology:
    - secrets
    - aws
  patterns:
  - pattern-either:
    - pattern: |
        $ACCOUNT_ID = $SECRET
    - pattern: |
        $ACCOUNT_ID : $SECRET
    - pattern: |
        $ACCOUNT_ID => $SECRET
    - pattern: |
        $ACCOUNT_ID = "$SECRET"
    - pattern: |
        $ACCOUNT_ID : "$SECRET"
    - pattern: |
        $ACCOUNT_ID => "$SECRET"
    - pattern: |
        "$ACCOUNT_ID" = "$SECRET"
    - pattern: |
        "$ACCOUNT_ID" : "$SECRET"
    - pattern: |
        "$ACCOUNT_ID" => "$SECRET"
  - metavariable-analysis:
      analyzer: entropy
      metavariable: $SECRET
  - metavariable-regex:
      metavariable: $SECRET
      regex: ^[0-9]{12}$
  - metavariable-regex:
      metavariable: $ACCOUNT_ID
      regex: (AWS|aws|Aws)?_?(ACCOUNT|account|Account)_?(ID|id|Id)?("|')?
  severity: ERROR
