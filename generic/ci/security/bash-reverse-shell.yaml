rules:
- id: bash_reverse_shell
  languages:
  - generic
  message: Semgrep found a bash reverse shell
  metadata:
    category: security
    cwe: 'CWE-552: Files or Directories Accessible to External Parties'
    technology:
    - ci
  pattern-either:
  - pattern: |
      sh -i >& /dev/udp/.../... 0>&1
  - pattern: |
      <...>/dev/tcp/.../...; sh <&... >&... 2>&
  - pattern: |
      <...>/dev/tcp/.../...; cat <&... | while read line; do $line 2>&... >&...;done
  - pattern: |
      sh -i ...<...> /dev/tcp/.../... ...<&... 1>&... 2>&
  severity: ERROR
