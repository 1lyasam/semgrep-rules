rules:
- fix-regex:
    regex: location\s+([A-Za-z0-9/-_\.]+)
    replacement: location \1/
  id: alias-path-traversal
  languages:
  - generic
  message: The alias in this location block is subject to a path traversal because
    the location path does not end in a path separator (e.g., '/'). To fix, add a
    path separator to the end of the path.
  metadata:
    category: security
    confidence: HIGH
    cwe: 'CWE-23: Relative Path Traversal'
    source-rule-url: https://github.com/yandex/gixy/blob/master/docs/en/plugins/aliastraversal.md
    technology:
    - nginx
  paths:
    include:
    - '*.conf'
    - '*.vhost'
    - sites-available/*
    - sites-enabled/*
  patterns:
  - pattern: |
      location ... {
        ...
        alias .../;
        ...
      }
  - pattern-not-inside: location /.../ { ... ... }
  severity: WARNING
