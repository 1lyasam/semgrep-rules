rules:
- id: tar-file-overwrite-vulnerability
  message: Potential tar file overwrite vulnerability. Extracting files without validating
    or sanitizing the file name can lead to an attacker overwriting or creating arbitrary
    files on the filesystem. Ensure that user input is properly validated and sanitized
    before being used in file extract operations to prevent file overwrite attacks.
  severity: WARNING
  pattern-either:
  - pattern: |
      def $Y($B,...):
         ...
         $T=tarfile.TarFile($B)
         $T.extractall("...")
         ...
  - pattern: |
      $TF = tarfile.TarFile(...)
      ...
      $TF.extract(...)
  languages:
  - python
  metadata:
    references:
    - https://docs.python.org/3/library/tarfile.html#tarfile.TarFile.extractall
    category: security
    technology:
    - python
    owasp:
    - A06:2017 - Security Misconfiguration
    - A05:2021 - Security Misconfiguration
    cwe:
    - 'CWE-22: Improper Limitation of a Pathname to a Restricted Directory (''Path
      Traversal'')'
    likelihood: MEDIUM
    impact: HIGH
    confidence: MEDIUM
    license: Commons Clause License Condition v1.0[LGPL-2.1-only]
