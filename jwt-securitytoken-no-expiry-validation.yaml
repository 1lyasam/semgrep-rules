rules:
- id: jwt-securitytoken-no-expiry-validation
  patterns:
  - pattern: ValidateLifetime = false
  - pattern-inside: new TokenValidationParameters {...}
  fix: ValidateLifetime = true
  message: A JWT Security token's lifetime must be validated. A JWT Security token
    can be compromised, and an attacker can exploit a token with an invalid lifetime.
  metadata:
    category: security
    technology:
    - csharp
    owasp:
    - "A07:2021 \u2013 Identification and Authentication Failures"
    cwe: 'CWE-613: Insufficient Session Expiration'
    references:
    - https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/
    - https://cwe.mitre.org/data/definitions/613.html
  languages:
  - csharp
  severity: ERROR
