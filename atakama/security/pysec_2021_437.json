rules:
- id: PYSEC-2021-437
  patterns:
    - pattern-inside: |
        "dependency": [
           ...
        ]
    - pattern: |
        {
          "id": "PYSEC-2021-437",
          "tool": "$TOOL",
          "project": "$PROJECT",
          "project_version": "$COMMIT",
          "dependency_name": "$DEPENDENCY",
          "dependency_finding_version": "$VERSION",
          "dependency_fix_versions": [$FIX_VERSIONS],
          ...
        }

  message: |
    PYSEC-2021-437 found in project $PROJECT:$COMMIT, by $TOOL in dependency $DEPENDENCY version $VERSION

    A flaw was found in python-pip in the way it handled Unicode separators in git references. A remote attacker could possibly use this issue to install a different revision on a repository. The highest threat from this vulnerability is to data integrity. This is fixed in python-pip version 21.1.

    Fixed Versions: $FIX_VERSIONS

    Aliases:

    - CVE-2021-3572

    - GHSA-5xp3-jfq3-5q8x

      
    Vulnerability published: 2021-11-10T18:15:00Z

    Vulnerability modified: 2021-11-29T23:42:09.374676Z

    References:

    - {'type': 'REPORT', 'url': 'https://bugzilla.redhat.com/show_bug.cgi?id=1962856'}

    - {'type': 'ADVISORY', 'url': 'https://github.com/advisories/GHSA-5xp3-jfq3-5q8x'}
    
  languages:
    - json
  severity: WARNING
  metadata:
    rule-origin-note: Generated by Atakama semgrep-rule-generator using the pypi advisory database https://github.com/pypa/advisory-database
    category: security