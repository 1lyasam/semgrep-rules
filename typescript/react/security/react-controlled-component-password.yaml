rules:
  - id: react-controlled-component-password
    pattern-either:
      - pattern: <$EL type="password" value={this.state.$X} onChange=...  />
      - pattern: |
          React.createElement($EL,{type: 'password', value: this.state.$X, onChange:...},...)
      - pattern: |
          $PARAMS = {type: 'password', value: this.state.$X, onChange:...};
          ...
          React.createElement($EL,$PARAMS,...);
    message: >-
      Password can be leaked if CSS injection exists on the page.
    metadata:
      category: security
      technology:
        - react
      owasp:
        - "A06:2007 - Information Leakage and Improper Error Handling"
        - "A01:2021 - Broken Access Control"
      cwe:
        - "CWE-200: Exposure of Sensitive Information to an Unauthorized Actor"
      references:
        - https://reactjs.org/docs/forms.html
    languages:
      - typescript
      - javascript
    severity: WARNING
