rules:
- id: cors-regex-wildcard
  languages:
  - ts
  message: 'Unescaped ''.'' character in CORS domain regex $CORS: $PATTERN'
  metadata:
    category: security
    cwe: "CWE-16: Configuration"
    technology:
    - cors
  patterns:
  - pattern-either:
    - pattern: const $CORS = [...,$PATTERN,...]
    - pattern: const $CORS = $PATTERN
  - metavariable-regex:
      metavariable: $PATTERN
      regex: .+?(?<!\\).\..+(?<!\\)\..+
  - metavariable-regex:
      metavariable: $CORS
      regex: (?i)cors
  severity: WARNING
