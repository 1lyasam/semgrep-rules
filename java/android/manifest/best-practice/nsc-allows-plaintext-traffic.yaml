rules:
- id: nsc-allows-plaintext-traffic
  languages:
  - generic
  message: >-
    The Network Security Config is set to allow non-encrypted connections.
    Evaluate if this is necessary for your app, and disable it if appropriate.
    (To hide this warning, set `xmlns:tools="http://schemas.android.com/tools"
    tools:ignore="InsecureBaseConfiguration"` as parameters to your
    `<network-security-config>`)
  metadata:
    category: best-practice
    license: Commons Clause License Condition v1.0[LGPL-2.1-only]
    technology:
    - android
    references:
    - https://developer.android.com/training/articles/security-config
    - https://www.nowsecure.com/blog/2018/08/15/a-security-analysts-guide-to-network-security-configuration-in-android-p/
  patterns:
  - pattern: |
      <base-config ... cleartextTrafficPermitted="true" ... >
  - pattern-not-inside: |
      <!-- ... -->
     # If the config explicitly tells us not to check for insecure configurations, respect that
      # (on a best-effort basis due to limitations of how much you can glob in generic parser mode)
  - pattern-not-inside: |
      <network-security-config ... InsecureBaseConfiguration ... >... ... ... ... ... ... ... ... ... ... </network-security-config>
  severity: INFO
  paths:
    include:
    - '*.xml'
