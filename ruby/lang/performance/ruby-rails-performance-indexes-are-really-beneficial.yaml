rules:
  - id: index-may-be-needed
    patterns:
      - pattern-not-inside: |
          add_column $TABLE, $COLUMN, $TYPE
          ...
          add_index $TABLE, $COLUMN
      - pattern: |
          add_column $TABLE, $COLUMN, $TYPE, ...
      - metavariable-regex:
          metavariable: $COLUMN
          regex: (.*_id$)
      - metavariable-regex:
          metavariable: $TYPE
          regex: (:integer)
      - focus-metavariable: $COLUMN
    metadata:
      category: performance
      technology:
        - rails
      references: 
        - https://archive.is/i7SLO
    message: >-
      The $COLUMN column appears to be a foreign key. Would it benefit from an
      index? 
    languages:
      - ruby
    severity: INFO
