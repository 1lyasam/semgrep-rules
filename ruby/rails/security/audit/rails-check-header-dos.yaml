id: rails-check-json-parsing-dos
patterns:
  - pattern-either:
      - patterns:
          - pattern: gem 'rails', '2.3.$PATCH'
          - metavariable-comparison:
              metavariable: $PATCH
              comparison: $PATCH >= 0 and $PATCH <= 14
      - patterns:
          - pattern: gem 'rails', '3.0.$PATCH'
          - metavariable-comparison:
              metavariable: $PATCH
              comparison: $PATCH >= 0 and $PATCH <= 19
      - pattern-either:
          - patterns:
              - pattern-either:
                  - pattern: gem 'rails', '~> 2.$MIN'
                  - pattern: gem 'rails', '~> 2.$MIN.$PATCH'
              - metavariable-comparison:
                  metavariable: $MIN
                  comparison: $MIN < 3
          - patterns:
              - pattern: gem 'rails', '~> 2.3.$PATCH'
              - metavariable-comparison:
                  metavariable: $PATCH
                  comparison: $PATCH < 16
          - patterns:
              - pattern: gem 'rails', '~> 3.0.$PATCH'
              - metavariable-comparison:
                  metavariable: $PATCH
                  comparison: $PATCH <= 19
  - pattern-not-inside: |
      ...
      gem 'yajl' ...
      ...
message: Rails versions 2.3.0 - 2.3.14 and 3.0.0 - 3.0.19 are vulnerable to a
  Remote Code Execution attack via JSON parsing (CVE-2013-0269). Either use the
  'yajl' gem or update to Rails 2.3.16 or greater if using Rails 2.3.0 - 2.3.14
  and Rails 3.0.20 or greater if using Rails 3.0.0 - 3.0.19
languages:
  - generic
severity: WARNING
paths:
  include:
    - "*Gemfile"
    - gems.rb

