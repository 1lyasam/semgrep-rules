rules:
  - id: rails-check-header-dos
    languages:
      - generic
    metadata:
      severity: WARNING
      technology:
        - rails
      category: security
      cwe: "CWE-20: Improper Input Validation"
      owasp:
        - "A09:2017 - Using Components with Known Vulnerabilities"
        - "A06:2021 - Vulnerable and Outdated Components"
    patterns:
      - pattern-either:
          - patterns:
              - pattern: gem 'rails', '3.$Y'
              - metavariable-comparison:
                  metavariable: $Y
                  comparison: $Y <= 2
          - patterns:
              - pattern-either:
                  - pattern: gem 'rails', '3.0.$Z'
                  - pattern: gem 'rails', '3.1.$Z'
          - patterns:
              - pattern: gem 'rails', '3.2.$Z'
              - metavariable-comparison:
                  metavariable: $Z
                  comparison: $Z < 16
          - patterns:
              - pattern: gem 'rails', '4.0.$Z'
              - metavariable-comparison:
                  metavariable: $Z
                  comparison: $Z == 0 or $Z == 1
    message: Rails versions 3.0.0 - 3.2.15 and 4.0.0 and 4.0.1 are vulnerable to a
      DoS attack (CVE-2013-6414).
    severity: WARNING
    paths:
      include:
        - Gemfile

