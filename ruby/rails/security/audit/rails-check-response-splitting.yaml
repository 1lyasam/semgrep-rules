id: rails-check-response-splitting
pattern-either:
  - pattern-either:
    - pattern: gem 'rails', '2.3'
    - patterns:
      - pattern-either:
        - pattern: gem 'rails', '2.3.$PATCH'
        - pattern: gem 'rails', '~> 2.3.$PATCH'
      - metavariable-comparison:
          metavariable: $PATCH
          comparison: $PATCH < 14
message: Rails versions 2.3.14 are vulnerable to response splitting, allowing header injection (CVE-2011-3186). Upgrade to 2.3.14 or greater.
languages:
  - generic
severity: WARNING
paths:
  include:
    - "*Gemfile"
    - gems.rb

