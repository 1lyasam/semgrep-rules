id: rails-check-json-parsing-rce
patterns:
  - pattern-either:
      - patterns:
          - pattern: gem 'rails', '2.3.$Z'
          - metavariable-comparison:
              metavariable: $Z
              comparison: $Z >= 0 and $Z <= 14
      - patterns:
          - pattern: gem 'rails', '3.0.$Z'
          - metavariable-comparison:
              metavariable: $Z
              comparison: $Z >= 0 and $Z <= 19
  - pattern-not-inside: |
      ...
      gem 'yajl' ...
      ...
message: Rails versions 2.3.0 - 2.3.14 and 3.0.0 - 3.0.19 are vulnerable to a
  Remote Code Execution attack via JSON parsing (CVE-2013-0333). Either use the
  'yajl' gem or update to Rails 2.3.16 or greater if using Rails 2.3.0 - 2.3.14
  and Rails 3.0.20 or greater if using Rails 3.0.0 - 3.0.19
languages:
  - generic
severity: WARNING
paths:
  include:
    - "*Gemfile"
    - "gems.rb"

