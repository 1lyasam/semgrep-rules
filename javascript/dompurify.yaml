rules:
- id: import-auth
  patterns:
  - pattern: DOMPurify.sanitize($X, ...)
  - pattern-not: |
      DOMPurify.sanitize($X, {RETURN_DOM_FRAGMENT: true});
  - pattern-not: |
      DOMPurify.sanitize($X, {RETURN_DOM: true});
  message: |
    DOMPurify.sanitize() was called without using RETURN_DOM or RETURN_DOM_FRAGMENT. Adding one of these options will harden against potential future DOMPurify exploits.
  languages:
  - js
  severity: ERROR
  fix: |
    DOMPurify.sanitize($X, {RETURN_DOM: true});
