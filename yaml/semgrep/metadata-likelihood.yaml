rules:
  - id: metadata-likelihood
    patterns:
      - pattern-inside: |
          rules: 
            ...
      - pattern-inside: |
          metadata: 
            ...
            category: security
            ...
      - pattern-not-inside: |
          metadata: 
            ...
            subcategory: $VALUE
    message: >
      Missing likelihood field.
    languages:
      - yaml
    severity: WARNING
    metadata:
      category: best-practice
      technology:
        - semgrep