rules:
  - id: metadata-likelihood
    patterns:
      - pattern-inside: |
          rules: 
            ...
      - pattern-inside: |
          metadata: 
            ...
            category: security
            ...
      - pattern-not-inside: |
          metadata: 
            ...
            likelihood: $VALUE
    message: >
      Missing likelihood field. Please include a likelihood field, 
      this tells users and Semgrep App about the rule likelihood 
      if how possible is this vulnerability going to occur, 
      we use LOW, MEDIUM, and HIGH indicators. For more information visit 
      https://semgrep.dev/docs/contributing/contributing-to-semgrep-rules-repository/
    languages:
      - yaml
    severity: WARNING
    metadata:
      references:
        - https://semgrep.dev/docs/contributing/contributing-to-semgrep-rules-repository/
      category: correctness
      technology:
        - semgrep