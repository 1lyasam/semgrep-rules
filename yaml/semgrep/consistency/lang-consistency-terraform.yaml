rules:
  - id: lang-consistency-terraform
    patterns:
      - pattern: $X
      - pattern-either:
          - pattern-inside: |
              languages:
                ...
      - metavariable-regex:
          metavariable: $X
          regex: ^(tf|terraform)$
    message: >-
      Found '$X' in language config which diverges from semgrep.dev normalization.
    languages:
      - yaml
    severity: WARNING
    fix: hcl
    metadata:
      category: correctness
      technology:
        - semgrep
