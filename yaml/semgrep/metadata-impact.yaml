rules:
  - id: metadata-impact
    patterns:
      - pattern-inside: |
          rules: 
            ...
      - pattern-inside: |
          metadata: 
            ...
            category: security
            ...
      - pattern-not-inside: |
          metadata: 
            ...
            impact: $VALUE
    message: >
      Missing impact field. Please include a impact field, 
      tells users and Semgrep App about the rule impact, and how much 'damage' 
      would this vulnerability would cause to the application, 
      we use LOW, MEDIUM, and HIGH indicators. For more information visit 
      https://semgrep.dev/docs/contributing/contributing-to-semgrep-rules-repository/
    languages:
      - yaml
    severity: WARNING
    metadata:
      references:
        - https://semgrep.dev/docs/writing-rules/rule-syntax/#TODO
      category: correctness
      technology:
        - semgrep