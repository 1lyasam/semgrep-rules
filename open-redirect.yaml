rules:
- id: open-redirect
  mode: taint
  pattern-sources:
  - patterns:
    - pattern: $REDIRECTURL
  pattern-sinks:
  - patterns:
    - pattern-inside: 'Redirect($REDIRECTURL)

        '
  pattern-sanitizers:
  - pattern: "if (IsLocalUrl($REDIRECTURL)) \n{ \n    ... Redirect($REDIRECTURL);\
      \ \n}\n"
  - pattern: "if (Url.IsLocalUrl($REDIRECTURL)) \n{ \n    ... Redirect($REDIRECTURL);\
      \ \n}\n"
  - pattern: "if ($URL.IsLocalUrl($REDIRECTURL)) \n{ \n    ... Redirect($REDIRECTURL);\
      \ \n}\n"
  message: A query string parameter may contain a URL value that could cause the web
    application to redirect the request to a malicious website controlled by an attacker.
  metadata:
    category: security
    technology:
    - csharp
    cwe: 'CWE-601: URL Redirection to Untrusted Site (''Open Redirect'')'
    references:
    - https://cwe.mitre.org/data/definitions/601.html
    owasp: A4:2021 insecure-design
  languages:
  - csharp
  severity: ERROR
